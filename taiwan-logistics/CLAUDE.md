# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

Taiwan Invoice Skill is an AI-powered toolkit for Taiwan E-Invoice integration, providing API documentation, code examples, and scripts for major invoice platforms (ECPay, SmilePay, Amego). It works as a skill/workflow for AI coding assistants (Claude Code, Windsurf, Cursor, etc.).

## Available Scripts

```bash
# Test API connectivity
python3 taiwan-invoice/scripts/test_connection.py <platform>

# Validate invoice data
python3 taiwan-invoice/scripts/validate_invoice.py <json_file>

# Generate invoice code
python3 taiwan-invoice/scripts/generate_code.py <platform> <language>
```

**Supported Platforms:** `ecpay`, `smilepay`, `amego`

## Architecture

```
taiwan-invoice/                     # Source of Truth
├── SKILL.md                        # Main skill documentation
├── EXAMPLES.md                     # Code examples and patterns
├── references/                     # API documentation
│   ├── ecpay-api.md
│   ├── smilepay-api.md
│   └── amego-api.md
└── scripts/                        # Utility scripts
    ├── test_connection.py
    ├── validate_invoice.py
    └── generate_code.py

cli/                                # CLI installer (taiwan-invoice-skill on npm)
├── src/
│   ├── commands/init.ts            # Install command with template generation
│   ├── utils/template.ts           # Template rendering engine
│   ├── utils/github.ts             # GitHub release downloads
│   └── utils/extract.ts            # ZIP extraction utilities
└── assets/                         # Bundled assets
    ├── taiwan-invoice/             # Copy of taiwan-invoice/
    └── templates/
        ├── base/                   # Base templates (skill-content.md)
        └── platforms/              # Platform configs (14 platforms)

.claude/skills/taiwan-invoice/      # Claude Code skill (generated by CLI)
```

## Sync Rules

**Source of Truth:** `taiwan-invoice/`

When modifying files:

1. **Skill Content** - Edit in `taiwan-invoice/`:
   - `SKILL.md` - Main documentation
   - `EXAMPLES.md` - Code examples
   - `references/*.md` - API documentation
   - `scripts/*.py` - Utility scripts

2. **Templates** - Edit in `cli/assets/templates/`:
   - `base/skill-content.md` - Common skill content
   - `platforms/*.json` - Platform-specific configs (14 platforms)

3. **CLI Assets** - Run sync before publishing:
   ```bash
   cp -r taiwan-invoice/* cli/assets/taiwan-invoice/
   ```

4. **Reference Folders** - No manual sync needed. The CLI generates these from templates during `taiwan-invoice init`.

## Supported AI Platforms

| Platform     | Folder      | Install Type |
|-------------|-------------|--------------|
| Claude Code | `.claude`   | full         |
| Cursor      | `.cursor`   | full         |
| Windsurf    | `.windsurf` | full         |
| Antigravity | `.agent`    | full         |
| Copilot     | `.github`   | full         |
| Kiro        | `.kiro`     | full         |
| Codex       | `.codex`    | full         |
| Qoder       | `.qoder`    | full         |
| Roo Code    | `.roo`      | full         |
| Gemini      | `.gemini`   | full         |
| Trae        | `.trae`     | full         |
| OpenCode    | `.opencode` | full         |
| Continue    | `.continue` | full         |
| CodeBuddy   | `.codebuddy`| full         |

## Prerequisites

- Node.js 18+ (for CLI)
- Python 3.x (for scripts, no external dependencies)

## Git Workflow

Never push directly to `main`. Always:

1. Create a new branch: `git checkout -b feat/...` or `fix/...`
2. Commit changes
3. Push branch: `git push -u origin <branch>`
4. Create PR: `gh pr create`
